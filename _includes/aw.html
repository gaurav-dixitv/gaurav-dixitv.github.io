
<LINK type="text/css" href="/assets/widgets/audio_player/css/style.css" rel="stylesheet"/>

<div class="row"> 
    <div class="column left" style="background-color: aliceblue;">
        <button class='playbutton' id='but'></button>
    </div>
    <div class="column right" style="background-color: bisque;">
        <span id="counter" class="timeline counter"></span>
        <div id="waveform" class="waveform" style="background-color: blueviolet";></div>
        <span id="duration" class="timeline duration"></span>
    </div>
</div>
source is: {{include.asource}}

<!--
<svg xmlns="http://www.w3.org/2000/svg" style="display:block;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="play" role="presentation" id="play-icon" aria-label="Play" class="playbutton2"><title id="play" lang="en">play icon</title> <g fill="currentColor"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="19" stroke="currentColor" stroke-width="2"></circle> <path d="M16 14L27.25 20L16 26L16 14Z" fill="currentColor"></path></svg></g></svg>

<svg xmlns="http://www.w3.org/2000/svg" style="display:none;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="pause" role="presentation" id="pause-icon" aria-label="Pause" class="pausebutton2"><title id="pause" lang="en">pause icon</title> <g fill="red"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="19" stroke="red" stroke-width="2"></circle> <rect x="15" y="14" width="3" height="12" fill="red"></rect> <rect x="22" y="14" width="3" height="12" fill="red"></rect></svg></g></svg>
-->

<!--
<svg xmlns="http://www.w3.org/2000/svg" style="display:block;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="play" role="presentation" id="play-icon" aria-label="Play" class="playbutton2"><title id="play" lang="en">play icon</title> <g fill="currentColor"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="16" stroke="currentColor" stroke-width="3"></circle> <path d="M16 14L27.25 20L16 26L16 14Z" fill="currentColor"></path></svg></g></svg>

<svg xmlns="http://www.w3.org/2000/svg" style="display:none;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="pause" role="presentation" id="pause-icon" aria-label="Pause" class="pausebutton2"><title id="pause" lang="en">pause icon</title> <g fill="red"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="20" r="16" stroke="red" stroke-width="3"></circle> <rect x="15" y="14" width="3" height="12" fill="red"></rect> <rect x="22" y="14" width="3" height="12" fill="red"></rect></svg></g></svg>
-->

<svg xmlns="http://www.w3.org/2000/svg" style="display:block;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="play" role="presentation" id="play-icon" aria-label="Play" class="playbutton2"><title id="play" lang="en">play icon</title> <g fill="currentColor"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M16 14L27.25 20L16 26L16 14Z" fill="currentColor"></path></svg></g></svg>

<svg xmlns="http://www.w3.org/2000/svg" style="display:none;" width="120" height="120" viewBox="0 0 40 40" aria-labelledby="pause" role="presentation" id="pause-icon" aria-label="Pause" class="pausebutton2"><title id="pause" lang="en">pause icon</title> <g fill="red"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="5" width="30" height="30" stroke="red" stroke-width="2"></rect> <rect x="15" y="14" width="3" height="12" fill="red"></rect> <rect x="22" y="14" width="3" height="12" fill="red"></rect></svg></g></svg>

<script>
    var wavesurfer = WaveSurfer.create({
        container: '#waveform',
        /*waveColor: '#828282',
        progressColor: '#333333',
        */
        waveColor: 'red',
        progressColor: 'blue',
        // cursorColor: 'transparent',
        cursorWidth: 0 ,
        barWidth: 1,
        barHeight: 1, // the height of the wave
        barGap: null,
        height:100,
    });

    var formatTime = function (time) {
        return [
            Math.floor((time % 3600) / 60), // minutes
            ('00' + Math.floor(time % 60)).slice(-2) // seconds
        ].join(':');
    };

    // Show current time
    wavesurfer.on('audioprocess', function () {
        document.getElementById("counter").innerText = formatTime(wavesurfer.getCurrentTime());
    });

    // Show clip duration
    wavesurfer.on('ready', function () {
        document.getElementById("duration").innerText = formatTime(wavesurfer.getDuration());
    });

    function toggle_svg(svg){
        if (svg.style.display == "none"){
            svg.style.display = "block";
        }
        else svg.style.display = "none";
    }

    wavesurfer.load("{{include.asource}}");

    let playbutton = document.getElementById("play-icon");
    let pausebutton = document.getElementById("pause-icon");

    console.log("playbutton: ", playbutton);

    playbutton.addEventListener('click', function() {
        console.log("clicked")
        wavesurfer.playPause();
        playbutton.style.display = "none";
        pausebutton.style.display = "block";
    });
    pausebutton.addEventListener('click', function() {
        console.log("clicked")
        wavesurfer.playPause();
        playbutton.style.display = "block";
        pausebutton.style.display = "none";
    });

    var btn = document.querySelector("button.playbutton")
    btn.addEventListener('click', function() {
        console.log("clicked")
        btn.classList.toggle("paused");
        wavesurfer.playPause();

        let playbutton = document.querySelector("playbutton2");
        toggle_svg(playbutton);
        let pausebutton = document.querySelector("pausebutton2");
        toggle_svg(pausebutton);

        return false;
    });

</script>
